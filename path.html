<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ninjatoshi — Shadow</title>
  <meta name="description" content="Shadow Universe. War Marks are recorded. War unlocks on Day 30." />

  <style>
    :root{
      --text:#e7e9ee;
      --muted:#a6adbb;
      --line:rgba(255,255,255,.12);
      --shadowAccent:#6aa6ff;
      --warAccent:#ff5a5f;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      overflow:hidden;
      background:#05080b;
    }
    a{color:inherit;text-decoration:none}

    /* Background (как Home) */
    .bg-atmosphere{
      position: fixed; inset: 0; pointer-events:none;
      background:url("assets/home-bg.jpg") center/cover no-repeat;
      filter: blur(18px) brightness(0.55);
      transform: scale(1.05);
      z-index: -4;
    }
    .bg-art{
      position: fixed; inset: 0; pointer-events:none;
      background:url("assets/home-bg.jpg") center/contain no-repeat;
      transform: scale(1.00);
      filter: drop-shadow(0 20px 60px rgba(0,0,0,.55));
      z-index: -3;
    }
    .overlay{
      position: fixed; inset: 0; pointer-events:none;
      background:
        radial-gradient(900px 520px at 30% 15%, rgba(0,0,0,.20), transparent 60%),
        radial-gradient(900px 520px at 80% 70%, rgba(0,0,0,.50), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.70));
      z-index: -2;
    }
    .grain{
      position:fixed; inset:0; pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.20'/%3E%3C/svg%3E");
      opacity:.10; mix-blend-mode:overlay;
      z-index:-1;
    }

    .wrap{
      min-height:100%;
      max-width:1100px;
      margin:0 auto;
      padding:22px 18px 26px;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .glass{
      background: rgba(0,0,0,.30);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 14px 16px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 0 30px rgba(0,0,0,.35);
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }

    .title{
      letter-spacing:.18em;
      font-weight:1000;
      text-transform:uppercase;
      font-size:13px;
      color:var(--shadowAccent);
    }
    .subtitle{
      margin-top:8px;
      color:var(--muted);
      line-height:1.4;
      font-size:13px;
    }

    .right{
      text-align:right;
      color:var(--muted);
      font-size:13px;
      line-height:1.3;
    }
    .right b{color:var(--text)}

    .grid{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:16px;
    }

    .cardTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
      font-weight:1000;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size:12px;
    }
    .badge{
      font-size:12px;
      color:var(--muted);
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 10px;
      background:rgba(0,0,0,.22);
      white-space:nowrap;
    }

    .progressLine{
      height:10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      overflow:hidden;
    }
    .progressFill{
      height:100%;
      width:0%;
      background: rgba(106,166,255,.35);
    }
    .small{
      margin-top:10px;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.07);
      color:var(--text);
      border-radius:14px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
      transition:transform .12s ease, background .12s ease;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);background:rgba(255,255,255,.10)}
    .btn.primary{
      border-color:rgba(106,166,255,.45);
      background:rgba(106,166,255,.16);
    }
    .btn.war{
      border-color:rgba(255,90,95,.45);
      background:rgba(255,90,95,.14);
    }
    .btn:disabled{
      opacity:.55;
      cursor:default;
      transform:none;
    }

    .marksList{
      margin:10px 0 0;
      padding:0;
      list-style:none;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .markItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
    }
    .markItem span{
      color:rgba(255,255,255,.86);
      font-size:13px;
    }
    .markItem small{
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    footer{
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:12px;
      color:var(--muted);
      font-size:12px;
    }

    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .right{text-align:left}
    }
  </style>
</head>

<body>
  <div class="bg-atmosphere"></div>
  <div class="bg-art"></div>
  <div class="overlay"></div>
  <div class="grain"></div>

  <div class="wrap">

    <header class="glass">
      <div>
        <div class="title">Shadow Universe</div>
        <div class="subtitle">War Marks are recorded. No noise. Only discipline.</div>
      </div>
      <div class="right">
        <div><b>Day</b> <span id="dayCount">1</span> / 180</div>
        <div>Next gate: <b>War</b> on Day 30</div>
      </div>
    </header>

    <section class="grid">

      <!-- War Marks -->
      <div class="glass" aria-label="War Marks">
        <div class="cardTitle">
          <div>War Marks</div>
          <div class="badge">Shadow</div>
        </div>

        <div class="small">
          One mark per day. Stored locally (localStorage — локальное хранилище браузера).
          <br>Streak: <b><span id="streak">0</span></b> days
        </div>

        <div class="actions">
          <button class="btn primary" id="markTodayBtn">Mark today</button>
          <button class="btn" id="resetMarksBtn" title="Очистить только отметки (для теста)">Reset marks</button>
        </div>

        <ul class="marksList" id="marksList"></ul>
      </div>

      <!-- Gate to War -->
      <div class="glass" aria-label="War Gate">
        <div class="cardTitle">
          <div>War Gate</div>
          <div class="badge">Day 30</div>
        </div>

        <div class="small" id="warStatusText">
          Locked. Endure until Day 30.
        </div>

        <div class="actions">
          <a class="btn war" id="enterWarBtn" href="war.html" style="display:none;">Enter War</a>
          <button class="btn war" id="warLockedBtn" disabled>Locked</button>
        </div>

        <div class="small">
          War opens only when the day count reaches 30.
        </div>
      </div>

    </section>

    <footer class="glass">
      <div>Four universes. One discipline.</div>
      <div>© <span id="y"></span> Ninjatoshi</div>
    </footer>

  </div>

  <script>
    // Year
    document.getElementById("y").textContent = new Date().getFullYear();

    // Day (demo)
    const day = Number(localStorage.getItem("dayCount") || 1);
    document.getElementById("dayCount").textContent = day;

    // ===== War gate =====
    const warStatusText = document.getElementById("warStatusText");
    const enterWarBtn = document.getElementById("enterWarBtn");
    const warLockedBtn = document.getElementById("warLockedBtn");

    if(day >= 30){
      warStatusText.textContent = "Unlocked. Pressure begins.";
      enterWarBtn.style.display = "inline-block";
      warLockedBtn.style.display = "none";
    } else {
      warStatusText.textContent = "Locked. Endure until Day 30.";
      enterWarBtn.style.display = "none";
      warLockedBtn.style.display = "inline-block";
    }

    // ===== War Marks (localStorage — локальное хранилище браузера) =====
    const keyMarks = "warMarks";
    const keyLastMarkDay = "warMarksLastDay";
    const keyStreak = "warMarksStreak";

    const marksListEl = document.getElementById("marksList");
    const markTodayBtn = document.getElementById("markTodayBtn");
    const resetMarksBtn = document.getElementById("resetMarksBtn");
    const streakEl = document.getElementById("streak");

    function loadMarks(){
      try{
        return JSON.parse(localStorage.getItem(keyMarks) || "[]");
      }catch(e){
        return [];
      }
    }
    function saveMarks(arr){
      localStorage.setItem(keyMarks, JSON.stringify(arr));
    }

    function renderMarks(){
      const marks = loadMarks();
      marksListEl.innerHTML = "";

      if(marks.length === 0){
        const li = document.createElement("li");
        li.className = "markItem";
        li.innerHTML = `<span>No marks yet.</span><small>Start today</small>`;
        marksListEl.appendChild(li);
      } else {
        // показываем последние сверху
        marks.slice().reverse().forEach(m => {
          const li = document.createElement("li");
          li.className = "markItem";
          li.innerHTML = `<span>${m.text}</span><small>Day ${m.day}</small>`;
          marksListEl.appendChild(li);
        });
      }

      const streak = Number(localStorage.getItem(keyStreak) || 0);
      streakEl.textContent = streak;

      // Блокируем кнопку, если уже отмечал этот день
      const lastDay = Number(localStorage.getItem(keyLastMarkDay) || 0);
      if(lastDay === day){
        markTodayBtn.disabled = true;
        markTodayBtn.textContent = "Marked";
      } else {
        markTodayBtn.disabled = false;
        markTodayBtn.textContent = "Mark today";
      }
    }

    markTodayBtn.addEventListener("click", () => {
      const marks = loadMarks();
      const lastDay = Number(localStorage.getItem(keyLastMarkDay) || 0);

      // защита: 1 mark на день
      if(lastDay === day) return;

      marks.push({
        day,
        text: "Mark recorded."
      });
      saveMarks(marks);

      // streak logic
      const prevDay = day - 1;
      const streak = Number(localStorage.getItem(keyStreak) || 0);
      const nextStreak = (lastDay === prevDay) ? (streak + 1) : 1;

      localStorage.setItem(keyStreak, String(nextStreak));
      localStorage.setItem(keyLastMarkDay, String(day));

      renderMarks();
    });

    resetMarksBtn.addEventListener("click", () => {
      localStorage.removeItem(keyMarks);
      localStorage.removeItem(keyLastMarkDay);
      localStorage.removeItem(keyStreak);
      renderMarks();
    });

    renderMarks();
  </script>
</body>
</html>
